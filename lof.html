<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    
  </body>
  <script src='//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'>
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/1.10.81/pdf.js'>
  </script>
  
  <script>
  PDFJS.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/1.10.81/pdf.worker.js'
  $(function() {
    google.script.run.withSuccessHandler(logIt).countPages();
  });
  
  var page_labs = {};
  
  function logIt(blob) {
    PDFJS.getDocument({data: blob}).then(function (PDFdoc) {
      for (var i=1; i<=PDFdoc.numPages; i++) {
        PDFdoc.getPage(i).then(function (PDFpage) {
        var page_number = PDFpage.pageIndex + 1;
        page_labs['Page ' + page_number] = [];
          PDFpage.getTextContent().then(function (text) {
            for (var j in text.items) {
              var item = text.items[j]
              if (item.height < 8 && item.width > 0) {
                page_labs['Page ' + page_number].push(item.str);
              }
            }       
          })
        })
      }
    })
    console.log(page_labs)
  }
  </script>

</html>
